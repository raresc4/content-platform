<div class="dashboard-page">
  <header class="header">
    <div class="header-left">
      <div class="logo">
        <svg
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <rect width="24" height="24" rx="6" fill="var(--color-primary)" />
          <path d="M8 8h8v2H8V8zm0 4h8v2H8v-2zm0 4h5v2H8v-2z" fill="white" />
        </svg>
      </div>
      <span class="logo-text">Media Library</span>
    </div>

    <div class="header-center">
      <div class="search-bar">
        <svg
          class="search-icon"
          width="20"
          height="20"
          viewBox="0 0 20 20"
          fill="none"
        >
          <path
            d="M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16zM19 19l-4.35-4.35"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
        </svg>
        <input
          type="text"
          [(ngModel)]="searchQuery"
          placeholder="Search your content..."
          class="search-input"
        />
      </div>

      <div class="content-tabs">
        <button
          *ngFor="let tab of contentTabs"
          [class.active]="tab.active"
          (click)="setContentTab(tab.id)"
          class="content-tab"
        >
          {{ tab.label }}
        </button>
      </div>
    </div>

    <div class="header-right">
      <div class="upload-container">
        <button class="upload-button" (click)="toggleUploadDropdown()">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
            <path
              d="M10 4v12M4 10h12"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
            />
          </svg>
          Upload
        </button>

        <div class="upload-dropdown" *ngIf="showUploadDropdown">
          <button
            *ngFor="let option of uploadOptions"
            (click)="handleUpload(option)"
            class="upload-option"
          >
            {{ option.label }}
          </button>
        </div>
      </div>

      <button class="user-icon">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
          <circle
            cx="12"
            cy="12"
            r="10"
            stroke="currentColor"
            stroke-width="2"
          />
          <circle cx="12" cy="10" r="3" fill="currentColor" />
          <path
            d="M6.168 18.849A6.5 6.5 0 0 1 12 15a6.5 6.5 0 0 1 5.832 3.849"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
          />
        </svg>
      </button>
    </div>
  </header>

  <main class="main-content">
    <div class="page-header">
      <div class="page-title-section">
        <h1 class="page-title">Media Library</h1>
        <p class="page-subtitle">Browse all available content</p>
      </div>
    </div>

    <div class="controls">
      <div class="filter-tabs">
        <button
          *ngFor="let tab of filterTabs"
          [class.active]="activeFilter === tab.id"
          (click)="setFilter(tab.id)"
          class="filter-tab"
        >
          {{ tab.label }}
        </button>
      </div>

      <div class="sort-dropdown">
        <svg
          class="sort-icon"
          width="20"
          height="20"
          viewBox="0 0 20 20"
          fill="none"
        >
          <path
            d="M3 6h14M6 10h11M9 14h8"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
          />
        </svg>
        <select [(ngModel)]="activeSort" class="sort-select">
          <option *ngFor="let option of sortOptions" [value]="option.value">
            {{ option.label }}
          </option>
        </select>
      </div>
    </div>

    <div class="media-grid">
      <div
        *ngFor="let item of mediaItems"
        class="media-card"
        (click)="openMediaItem(item)"
      >
        <div class="card-thumbnail">
          <span class="badge" [ngClass]="getBadgeClass(item.type)">
            {{ getBadgeLabel(item) }}
          </span>
          <img
            [src]="item.thumbnailUrl"
            [alt]="item.title"
            class="thumbnail-image"
          />
          <div class="duration-overlay" *ngIf="item.duration">
            {{ item.duration }}
          </div>
        </div>

        <div class="card-content">
          <div class="card-header">
            <h3 class="card-title">{{ item.title }}</h3>
            <button class="menu-button">
              <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                <circle cx="10" cy="4" r="1.5" fill="currentColor" />
                <circle cx="10" cy="10" r="1.5" fill="currentColor" />
                <circle cx="10" cy="16" r="1.5" fill="currentColor" />
              </svg>
            </button>
          </div>

          <div class="card-meta">
            <span class="meta-date">{{ formatDate(item.uploadDate) }}</span>
            <span class="meta-separator">•</span>

            <span class="meta-info" *ngIf="item.dimensions">
              {{ item.dimensions.width }} × {{ item.dimensions.height }}
            </span>
            <span class="meta-info" *ngIf="item.pages">
              {{ item.pages }} pages
            </span>
            <span class="meta-info" *ngIf="item.views">
              {{ formatViews(item.views) }} views
            </span>
          </div>

          <div class="card-footer">
            <span class="file-size">{{ formatFileSize(item.size) }}</span>
            <button (click)="downloadMedia(item)" class="download-button">
              <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                <path
                  d="M14 10v2.667A1.333 1.333 0 0 1 12.667 14H3.333A1.333 1.333 0 0 1 2 12.667V10M11.333 7.333L8 10.667m0 0L4.667 7.333M8 10.667V2"
                  stroke="currentColor"
                  stroke-width="1.5"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
              Download
            </button>
          </div>
        </div>
      </div>
    </div>

    <div *ngIf="mediaItems.length === 0" class="empty-state">
      <svg width="64" height="64" viewBox="0 0 64 64" fill="none">
        <circle cx="32" cy="32" r="32" fill="var(--color-bg-tertiary)" />
        <path
          d="M32 20v24M20 32h24"
          stroke="var(--color-text-tertiary)"
          stroke-width="2"
          stroke-linecap="round"
        />
      </svg>
      <h3>No content found</h3>
      <p>Try adjusting your search or filters</p>
    </div>
  </main>

  <!-- Image Popup -->
  <app-image-popup
    [mediaItem]="selectedMediaItem"
    [isOpen]="showImagePopup"
    (closePopup)="closeImagePopup()"
  ></app-image-popup>
</div>
