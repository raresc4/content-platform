<div class="profile-page">
  <app-header
    [searchQuery]="searchQuery"
    [contentTabs]="contentTabs"
    [uploadOptions]="uploadOptions"
    [showUploadDropdown]="showUploadDropdown"
    (searchQueryChange)="searchQuery = $event"
    (contentTabChange)="setContentTab($event)"
    (uploadClick)="handleUpload($event)"
    (uploadDropdownToggle)="toggleUploadDropdown()"
    (userIconClick)="handleUserIconClick()"
  ></app-header>

  <main class="main-content">
    <!-- Page Header -->
    <div class="page-header">
      <h1 class="page-title">Profile</h1>
      <p class="page-subtitle">Manage your account and view your activity</p>
    </div>

    <!-- Profile Card -->
    <div class="profile-card">
      <div class="banner-gradient"></div>

      <div class="profile-content">
        <div class="profile-top">
          <div class="profile-left">
            <div class="avatar-container">
              <img
                *ngIf="userProfile?.avatarUrl"
                [src]="userProfile?.avatarUrl"
                [alt]="
                  (userProfile?.firstName || '') +
                  ' ' +
                  (userProfile?.lastName || '')
                "
                class="avatar"
              />
              <div *ngIf="!userProfile?.avatarUrl" class="avatar-placeholder">
                <svg width="48" height="48" viewBox="0 0 24 24" fill="none">
                  <circle cx="12" cy="10" r="3" fill="currentColor" />
                  <path
                    d="M6.168 18.849A6.5 6.5 0 0 1 12 15a6.5 6.5 0 0 1 5.832 3.849"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                  />
                </svg>
              </div>
            </div>
            <div class="profile-info">
              <h2 class="profile-name">
                {{ userProfile?.firstName }} {{ userProfile?.lastName }}
              </h2>
              <p class="profile-role">{{ userProfile?.role }}</p>
            </div>
          </div>

          <button class="edit-profile-button">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
              <path
                d="M11.333 2A1.886 1.886 0 0 1 14 4.667l-9 9-3.667.666.667-3.666 9-9z"
                stroke="currentColor"
                stroke-width="1.5"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
            Edit Profile
          </button>
        </div>

        <div class="profile-metadata">
          <div class="metadata-item">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
              <path
                d="M2.667 4l5.333 3.333L13.333 4M2.667 12h10.666c.737 0 1.334-.597 1.334-1.333V5.333c0-.736-.597-1.333-1.334-1.333H2.667c-.737 0-1.334.597-1.334 1.333v5.334c0 .736.597 1.333 1.334 1.333z"
                stroke="currentColor"
                stroke-width="1.5"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
            <span>{{ userProfile?.email }}</span>
          </div>

          <div class="metadata-item">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
              <path
                d="M14 6.667C14 11.333 8 15.333 8 15.333S2 11.333 2 6.667a6 6 0 1 1 12 0z"
                stroke="currentColor"
                stroke-width="1.5"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
              <circle
                cx="8"
                cy="7"
                r="2"
                stroke="currentColor"
                stroke-width="1.5"
              />
            </svg>
            <span>San Francisco, CA</span>
          </div>

          <div class="metadata-item">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
              <rect
                x="2"
                y="3.333"
                width="12"
                height="10.667"
                rx="2"
                stroke="currentColor"
                stroke-width="1.5"
              />
              <path
                d="M10.667 1.333v4M5.333 1.333v4"
                stroke="currentColor"
                stroke-width="1.5"
                stroke-linecap="round"
              />
            </svg>
            <span>Joined {{ formatDate(userProfile?.joinDate!) }}</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Statistics Cards -->
    <div class="stats-section">
      <div class="stat-card">
        <div class="stat-icon stat-icon-videos">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
            <path
              d="M23 7l-7 5 7 5V7zM14 5H3a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h11a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2z"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
          </svg>
        </div>
        <div class="stat-content">
          <div class="stat-header">
            <p class="stat-label">Videos</p>
            <span class="stat-change stat-change-positive"
              >+{{ userStats?.videosChange }}%</span
            >
          </div>
          <h3 class="stat-value">
            {{ formatNumber(userStats?.videosCount!) }}
          </h3>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-icon stat-icon-images">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
            <rect
              x="3"
              y="3"
              width="18"
              height="18"
              rx="2"
              stroke="currentColor"
              stroke-width="2"
            />
            <circle cx="8.5" cy="8.5" r="1.5" fill="currentColor" />
            <path
              d="M21 15l-5-5L5 21"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
          </svg>
        </div>
        <div class="stat-content">
          <div class="stat-header">
            <p class="stat-label">Images</p>
            <span class="stat-change stat-change-positive"
              >+{{ userStats?.imagesChange }}%</span
            >
          </div>
          <h3 class="stat-value">
            {{ formatNumber(userStats?.imagesCount!) }}
          </h3>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-icon stat-icon-pdfs">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
            <path
              d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6z"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
            <path
              d="M14 2v6h6M10 13h4M10 17h4M10 9h1"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
            />
          </svg>
        </div>
        <div class="stat-content">
          <div class="stat-header">
            <p class="stat-label">PDFs</p>
            <span class="stat-change stat-change-positive"
              >+{{ userStats?.pdfsChange }}%</span
            >
          </div>
          <h3 class="stat-value">{{ formatNumber(userStats?.pdfsCount!) }}</h3>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-icon stat-icon-views">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
            <path
              d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
            <circle
              cx="12"
              cy="12"
              r="3"
              stroke="currentColor"
              stroke-width="2"
            />
          </svg>
        </div>
        <div class="stat-content">
          <div class="stat-header">
            <p class="stat-label">Total Views</p>
            <span class="stat-change stat-change-positive"
              >+{{ userStats?.viewsChange }}%</span
            >
          </div>
          <h3 class="stat-value">{{ formatNumber(userStats?.totalViews!) }}</h3>
        </div>
      </div>
    </div>

    <!-- Storage Section -->
    <div class="storage-section">
      <div class="section-header">
        <h2 class="section-title">Storage Overview</h2>
        <p class="section-subtitle">
          {{ formatStorageSize(storageInfo?.used!) }} of
          {{ formatStorageSize(storageInfo?.total!) }} used
        </p>
      </div>

      <div class="storage-progress">
        <div class="progress-bar">
          <div class="progress-fill" [style.width.%]="storagePercentage"></div>
        </div>
        <p class="progress-label">{{ storagePercentage.toFixed(1) }}% Used</p>
      </div>

      <div class="storage-breakdown">
        <div class="breakdown-item">
          <div class="breakdown-header">
            <div class="breakdown-label">
              <span class="breakdown-dot breakdown-dot-video"></span>
              <span>Videos</span>
            </div>
            <span class="breakdown-value">{{
              formatStorageSize(storageInfo?.breakdown?.videos || 0)
            }}</span>
          </div>
          <div class="breakdown-bar">
            <div
              class="breakdown-fill breakdown-fill-video"
              [style.width.%]="breakdownPercentages.videos"
            ></div>
          </div>
        </div>

        <div class="breakdown-item">
          <div class="breakdown-header">
            <div class="breakdown-label">
              <span class="breakdown-dot breakdown-dot-image"></span>
              <span>Images</span>
            </div>
            <span class="breakdown-value">{{
              formatStorageSize(storageInfo?.breakdown?.images || 0)
            }}</span>
          </div>
          <div class="breakdown-bar">
            <div
              class="breakdown-fill breakdown-fill-image"
              [style.width.%]="breakdownPercentages.images"
            ></div>
          </div>
        </div>

        <div class="breakdown-item">
          <div class="breakdown-header">
            <div class="breakdown-label">
              <span class="breakdown-dot breakdown-dot-pdf"></span>
              <span>PDFs</span>
            </div>
            <span class="breakdown-value">{{
              formatStorageSize(storageInfo?.breakdown?.pdfs || 0)
            }}</span>
          </div>
          <div class="breakdown-bar">
            <div
              class="breakdown-fill breakdown-fill-pdf"
              [style.width.%]="breakdownPercentages.pdfs"
            ></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Upload Activity Section -->
    <div class="activity-section">
      <div class="section-header">
        <h2 class="section-title">Upload Activity</h2>
        <p class="section-subtitle">Last 14 days</p>
      </div>

      <div class="activity-chart">
        <div
          *ngFor="let activity of uploadActivity"
          class="activity-bar-container"
        >
          <div class="activity-bar-wrapper">
            <div
              class="activity-bar"
              [style.height.%]="getActivityBarHeight(activity.count)"
              [attr.data-count]="activity.count"
            >
              <span class="activity-tooltip">{{ activity.count }} uploads</span>
            </div>
          </div>
          <span class="activity-label">{{ activity.date.getDate() }}</span>
        </div>
      </div>
    </div>

    <!-- Recent Uploads Section -->
    <div class="recent-section">
      <div class="section-header">
        <h2 class="section-title">Recent Uploads</h2>
        <a href="#" class="view-all-link">View All</a>
      </div>

      <div class="recent-grid">
        <div *ngFor="let upload of recentUploads" class="recent-card">
          <div class="recent-thumbnail">
            <span class="badge" [ngClass]="getBadgeClass(upload.type)">
              {{ upload.type.toUpperCase() }}
            </span>
            <img
              [src]="upload.thumbnailUrl"
              [alt]="upload.title"
              class="thumbnail-image"
            />
          </div>
          <div class="recent-content">
            <h4 class="recent-title">{{ upload.title }}</h4>
            <div class="recent-meta">
              <span class="recent-date">{{
                formatDate(upload.uploadDate)
              }}</span>
              <span class="meta-separator">â€¢</span>
              <span class="recent-size">{{
                formatStorageSize(upload.size)
              }}</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>
